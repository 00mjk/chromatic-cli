"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"isChromatic",{enumerable:!0,get:function get(){return _isChromatic["default"]}});var _taggedTemplateLiteral2=_interopRequireDefault(require("@babel/runtime/helpers/taggedTemplateLiteral")),_regenerator=_interopRequireDefault(require("@babel/runtime/regenerator")),_toConsumableArray2=_interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray")),_defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty")),_utilDeprecate=_interopRequireDefault(require("util-deprecate")),_tsDedent=_interopRequireDefault(require("ts-dedent")),_isChromatic=_interopRequireDefault(require("./isChromatic"));function _templateObject(){var a=(0,_taggedTemplateLiteral2["default"])(["\n    You're importing 'storybook-chromatic' in your config.js\n    This is no longer necessary!\n\n    If you're importing { isChromatic } in your stories, please change that to:\n    \"import isChromatic from \"storybook-chromatic/isChromatic\";\"\n  "]);return _templateObject=function(){return a},a}function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(b,!0).forEach(function(c){(0,_defineProperty2["default"])(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(b).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}var CHROMATIC_PARAMETERS=["viewports","delay","disable","noScroll","diffThreshold","pauseAnimationAtEnd"];function specFromStory(a){var b=a.id,c=a.kind,d=a.name,e=a.parameters;e=void 0===e?{}:e;var f=e.chromatic,g=function(a){return"function"==typeof a?a({id:b,kind:c,name:d}):a};return{storyId:b,name:d,component:{name:c,displayName:c.split(/\||\/|\./).slice(-1)[0]},parameters:f&&CHROMATIC_PARAMETERS.reduce(function(a,b){return f[b]?_objectSpread({},a,(0,_defineProperty2["default"])({},b,g(f[b]))):a},{})}}var extract=function(a){var b=a.__STORYBOOK_CLIENT_API__;if(!b)throw new Error("Chromatic requires Storybook version at least 3.4. Please update your Storybook!");var c=b._storyStore;return c.extract?Object.values(c.extract()).map(specFromStory):b.getStorybook().map(function(a){var b=a.kind,d=a.stories;return d.map(function(a){var d=a.name;return specFromStory({kind:b,name:d,parameters:c.getStoryAndParameters&&c.getStoryAndParameters(b,d).parameters})})}).reduce(function(c,a){return[].concat((0,_toConsumableArray2["default"])(c),(0,_toConsumableArray2["default"])(a))},[])};(0,_utilDeprecate["default"])(function(){global.__renderChromaticSpec__=Object.assign(function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o;return _regenerator["default"].async(function(p){for(;;)switch(p.prev=p.next){case 0:if(b=a.storyId,c=a.name,d=a.component.name,e=global,f=e.__STORYBOOK_CLIENT_API__,g=e.__STORYBOOK_ADDONS_CHANNEL__,f||g){p.next=4;break}throw new Error("Chromatic requires Storybook version at least 3.4. Please update your Storybook!");case 4:if(h=function(a){return a.toLowerCase().replace(/[ ’–—―′¿'`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/gi,"-").replace(/-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")},i=function(a,b){var c=h(a);if(""===c)throw new Error("Invalid ".concat(b," '").concat(a,"', must include alphanumeric characters"));return c},j=function(a,b){return"".concat(i(a,"kind"),"--").concat(i(b,"name"))},k=g,l=f._storyStore,!l.extract){p.next=11;break}return p.abrupt("return",new Promise(function(a,e){k.on("storyRendered",function(){return a(document.getElementById("root"))}),k.on("storyUnchanged",function(){return a(document.getElementById("root"))}),k.on("storyErrored",function(a){return e(a)}),k.on("storyThrewException",function(a){return e(a)}),k.on("storyMissing",function(){return e(new Error("storyMissing"))}),k.emit("setCurrentStory",{storyId:b||j(d,c)})}));case 11:if(k._handleEvent({type:"setCurrentStory",args:[{kind:d,story:c}],from:"chromatic"}),!document.body.classList.contains("sb-show-errordisplay")){p.next=18;break}throw m=document.getElementById("error-message").textContent,n=document.getElementById("error-stack").textContent,o=new Error(m),o.stack=n,o;case 18:return p.abrupt("return",document.getElementById("root"));case 19:case"end":return p.stop();}})},{isDeprecated:!0}),global.__chromaticRuntimeSpecs__=Object.assign(function(){return _regenerator["default"].async(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",extract(global));case 1:case"end":return a.stop();}})},{isDeprecated:!0})},(0,_tsDedent["default"])(_templateObject()))();
//# sourceMappingURL=storybook-addon.js.map